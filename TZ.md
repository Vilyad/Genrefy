# Техническое задание: Genrefy

## 1. Цель проекта
Разработка веб-сервиса для анализа музыкальных жанров и акустических характеристик треков, предназначенного для начинающих музыкальных продюсеров. Сервис помогает находить релевантные примеры для изучения, понимать основные акустические характеристики жанров и сравнивать аудио-параметры.

**Актуальность проекта:** Начинающим продюсерам необходимо анализировать акустические характеристики успешных треков в выбранных жанрах. Ручной анализ требует времени и специальных знаний, тогда как автоматизированная система предоставляет структурированные аудио-данные и визуализации.

## 2. Архитектурное решение

### Выбор технологии:

Используется комбинация двух открытых музыкальных API:

1. **MusicBrainz API** (основной источник):
   - **Доступность:** Работает без географических ограничений
   - **Бесплатно:** Нет лимитов по количеству запросов (только 1 запрос/секунду)
   - **Богатая база:** 2+ миллионов записей, теги, жанровая информация
   - **Открытые данные:** Community-driven проект без коммерческих ограничений

2. **AcousticBrainz API** (для аудио-анализа):
   - **Акустические характеристики:** Предоставляет более 1000 аудио-признаков
   - **Машинное обучение:** Классификация жанров, настроений, инструментов
   - **Интеграция:** Прямая совместимость с MusicBrainz (общие идентификаторы)

## 3. Роли пользователей
- **Гость (неавторизованный пользователь)**:
   - Просмотр каталога музыкальных жанров
   - Поиск треков через MusicBrainz API
   - Анализ акустических характеристик отдельных треков
   - Сравнение жанров по аудио-параметрам
   - Доступ к интерактивным графикам и визуализациям

- **Зарегистрированный пользователь (планируется в будущем)**:
   - Сохранение избранных треков для сравнения
   - Создание коллекций по акустическим паттернам
   - Отслеживание изменений в аудио-характеристиках
   - Экспорт данных анализа для внешних инструментов

- **Администратор**:
   - Управление контентом через Django Admin
   - Обновление данных через внешние API
   - Модерация пользовательских коллекций
   - Анализ использования системы

## 4. Модели данных
### Модель 1: Genre (Музыкальный жанр)
- `name` - название жанра (CharField, 100)
- `description` - описание жанра (TextField)
- `musicbrainz_tag` - соответствующий тег в MusicBrainz (CharField, 100)
- `created_at` - дата создания (DateTimeField)
- `updated_at` - дата обновления (DateTimeField)

### Модель 2: Artist (Исполнитель)
- `name` - имя исполнителя (CharField, 200)
- `musicbrainz_id` - ID в MusicBrainz (CharField, 100, уникальный)
- `description` - описание исполнителя (TextField)
- `genres` - жанры исполнителя (ManyToMany с Genre)
- `created_at` - дата добавления (DateTimeField)

### Модель 3: Track (Музыкальный трек)
- `title` - название трека (CharField, 200)
- `artist` - исполнитель (ForeignKey к Artist)
- `musicbrainz_id` - ID в MusicBrainz (CharField, 100, уникальный)
- `audio_features` - JSON с акустическими характеристиками (JSONField)
- `acoustic_data` - полный анализ от AcousticBrainz (JSONField)
- `genres` - список жанров (TextField)
- `duration` - продолжительность в секундах (IntegerField, null=True)
- `is_reference` - является ли референс-треком (BooleanField, default=False)
- `created_at` - дата добавления (DateTimeField)

## 5. Ключевые сценарии (User Stories)

### Базовый функционал:
1. **"Как пользователь, я хочу искать треки через MusicBrainz API"**
   - Форма поиска по названию трека и исполнителю
   - Результаты с информацией из MusicBrainz
   - Возможность добавления найденных треков в базу

2. **"Как продюсер, я хочу анализировать акустические характеристики трека"**
   - Детальная страница трека с данными из AcousticBrainz
   - Интерактивные графики аудио-параметров
   - Визуализация жанровой классификации

3. **"Как пользователь, я хочу сравнивать жанры по аудио-параметрам"**
   - Сравнение средних характеристик разных жанров
   - Интерактивные графики сравнения
   - Статистика по танцевальности, энергии, валентности и другим параметрам

## 6. Технический стек
### Backend:
- **Фреймворк:** Django 5.2 (Python 3.10+)
- **База данных:** SQLite (разработка), PostgreSQL (продакшен)
- **ORM:** Django ORM с расширенными запросами

### Внешние API и библиотеки:
- **MusicBrainz API** (`musicbrainzngs`) - метаданные о треках и артистах
- **AcousticBrainz API** - акустический анализ и характеристики
- **Pandas** - обработка и анализ аудио-данных
- **NumPy** - численные вычисления для анализа
- **Plotly** - интерактивные графики и визуализации

### Frontend:
- **Bootstrap 5** - адаптивный интерфейс
- **Plotly.js** - динамические графики на клиенте
- **JavaScript (ES6+)** - интерактивные элементы

### Инфраструктура:
- **Хостинг:** PythonAnywhere
- **Версионный контроль:** Git, GitHub
- **Конфигурация:** python-dotenv, environment variables
- **Кэширование:** Локальное кэширование API запросов

## 7. Архитектура системы
### Поток данных:
```
Пользовательский запрос
           ↓
[   MusicBrainz API   ] → Метаданные, теги, информация
           ↓
[  AcousticBrainz API ] → Акустические характеристики
           ↓
[    Локальная БД     ] → Сохранение и индексация
           ↓
[   Pandas + NumPy    ] → Статистический анализ
           ↓
[   Plotly + Django   ] → Визуализация и представление
           ↓
Пользовательский интерфейс
```

### Ключевые сервисы:
1. **MusicBrainzService** - работа с MusicBrainz API
2. **AcousticBrainzService** - получение акустических характеристик
3. **AudioAnalyzer** - статистический анализ аудио-данных
4. **VisualizationEngine** - генерация графиков и визуализаций

## 8. Критерии успеха

### Технические критерии:
1. **Работоспособность:** Все страницы загружаются без ошибок
2. **API интеграция:** Успешные запросы к MusicBrainz и AcousticBrainz API
3. **Производительность:** Загрузка страниц за 2-3 секунды
4. **Данные:** 10-15 демо-записей в базе данных с полным аудио-анализом

### Функциональные критерии:
1. **Поиск треков:** Работающая форма поиска через MusicBrainz
2. **Аудио-анализ:** Отображение акустических характеристик из AcousticBrainz
3. **Визуализация:** Интерактивные графики для анализа параметров
4. **Сравнение жанров:** Функциональность сравнения по аудио-характеристикам
5. **Интерфейс:** Адаптивный и понятный дизайн с Bootstrap 5

## 9. Изменения в ходе реализации

### 20.12.2025: Первоначальная версия
- Утверждена базовая структура проекта
- Определены 3 основные модели

### 22.12.2025: Переход с Spotify API на Last.fm API
- **Причина:** Географические ограничения Spotify API
- **Решение:** Использование Last.fm API как более доступной альтернативы

### 23.12.2025: Миграция на MusicBrainz/AcousticBrainz API
- **Причина:** Last.fm ограничивает бесплатные запросы, требует API ключ
- **Решение:** Использование полностью открытых MusicBrainz и AcousticBrainz API
- **Преимущества:** 
  - Бесплатно без ограничений по количеству запросов
  - Прямой доступ к акустическому анализу
  - Более глубокая техническая информация
  - Работает в России без ограничений